{{- $src := .Get "src" -}}
{{- $title := .Get "title" | default "" -}}
{{- $description := .Get "description" | default "" -}}
{{- if not (.Page.Scratch.Get "audioScriptEmitted") -}}
{{- .Page.Scratch.Set "audioScriptEmitted" true -}}
<script>
document.addEventListener('DOMContentLoaded', function () {
  var players = document.querySelectorAll('audio.audio-player');
  players.forEach(function (current) {
    current.addEventListener('play', function () {
      players.forEach(function (other) {
        if (other !== current) other.pause();
      });
    });
  });
});
</script>
{{- end -}}
{{- /* Uses static/tracks: MP3s in static/tracks/; src e.g. "tracks/file.mp3" â†’ /tracks/file.mp3 */ -}}
<figure class="audio-player-figure">
  {{- if $title }}
  <figcaption>{{ $title }}</figcaption>
  {{- end }}
  {{- if $description }}
  <p class="audio-player-description"><small>{{ $description }}</small></p>
  {{- end }}
  <audio class="audio-player" controls preload="metadata">
    <source src="/{{ $src }}" type="audio/mpeg">
    <p>Your browser does not support the <code>audio</code> element. <a href="/{{ $src }}">Download the track</a>.</p>
  </audio>
</figure>
